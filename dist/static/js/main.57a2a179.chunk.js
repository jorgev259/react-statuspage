(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{112:function(e,t,a){},137:function(e,t){},177:function(e,t,a){"use strict";a.r(t);var n=a(16),c=a.n(n),s=a(22),r=(a(110),a(111),a(112),a(100)),i=a.n(r),l=a(40),j=a(25),d=a(51),b=a.n(d),o=a(13),u=a(182),m=a(101),x=a(185),O=a(183),h=a(56),p=a(6),v=a.n(p),g=a(1);function f(e){var t="";return null!==e&&(t="green",e<99&&(t="lightgreen"),e<95&&(t="yellow"),e<90&&(t="red")),t}function y(e){var t=e.first,a=e.last,n=e.service,c=e.nameFlag,s=void 0!==c&&c,r=n.name,i=n.uptimeDays,j=n.state,d=i.map((function(e){return e.uptime})),b=d.reduce((function(e,t){return e+t}),0)/d.length,o=function(e){for(var t=e.start.startOf("day"),a=e.end.endOf("day"),n=[];t<a;)n.push(t.toISODate()),t=t.plus({days:1});return n}(h.Interval.fromDateTimes(h.DateTime.now().minus({days:89}),h.DateTime.now()));return Object(g.jsx)(u.a,{className:v()("infoRow",{first:t,"pt-4":!t,"pb-4":!a}),children:Object(g.jsxs)(m.a,{children:[Object(g.jsxs)(u.a,{className:"info",children:[Object(g.jsxs)(m.a,{className:"pl-0",children:[s&&Object(g.jsxs)(g.Fragment,{children:[Object(g.jsx)(l.A,{href:"/service/".concat(n.id),children:Object(g.jsxs)("span",{style:{color:"white"},children:[r," \u279f "]})}),Object(g.jsx)("span",{className:"mx-1",children:"|"})]}),Object(g.jsxs)("span",{className:f(b),children:[b.toFixed(2),"%"]})]}),Object(g.jsxs)(m.a,{xs:"auto",className:v()("d-flex align-items-center pr-0",{lightgreen:j,red:!j}),children:[Object(g.jsx)("div",{className:"status mx-1",style:{width:"20px",height:"20px"}}),Object(g.jsx)("span",{children:j?"Operational":"Down"})]})]}),Object(g.jsx)(u.a,{className:"flex-nowrap mt-3 justify-content-end",children:o.map((function(e){var t=i.find((function(t){return t.date===e}));return Object(g.jsx)(N,{date:e,value:t?t.uptime:null},e)}))})]})})}function N(e){var t=e.value,a=e.date,n=f(t);return Object(g.jsx)(x.a,{placement:"top",overlay:Object(g.jsxs)(O.a,{children:[a,Object(g.jsx)("br",{}),t?"".concat(t.toFixed(2),"%"):""]}),children:Object(g.jsx)(m.a,{className:"tick px-0",children:Object(g.jsx)("div",{className:n})})})}var F,w,L=a(31),S=a.n(L),q=Object(o.gql)(F||(F=Object(s.a)(["\n  query Services {\n    services {\n      id\n      name\n      url\n      order\n      state\n\n      uptimeDays(days: 90) {\n        date\n        uptime\n      }\n    }\n  }\n"]))),$=Object(o.gql)(w||(w=Object(s.a)(["\n  query Overall {\n    uptime1: uptime(days: 1)\n    uptime7: uptime(days: 7)\n    uptime30: uptime(days: 30)\n    uptime90: uptime(days: 90)\n  }\n"])));function C(){var e=Object(o.useQuery)(q),t=e.data,a=e.loading,n=t&&t.services.every((function(e){return e.state})),c=t&&t.services.every((function(e){return!e.state}));return Object(g.jsxs)(g.Fragment,{children:[Object(g.jsx)(u.a,{className:v()("mainBox",{yellow:!c&&!n,red:c,lightgreen:n}),children:a?Object(g.jsx)(m.a,{className:"d-flex border-0 justify-content-center",children:Object(g.jsx)(S.a,{type:"pacman",active:!0})}):Object(g.jsxs)(m.a,{className:v()("d-flex align-items-center",{"justify-content-center":a}),children:[Object(g.jsx)("div",{className:"status mr-2",style:{width:"20px",height:"20px"}}),Object(g.jsx)("h2",{className:"my-auto",style:{fontWeight:"bold"},children:c||n?n?"All systems operational":"All systems down":"Some systems down"})]})}),Object(g.jsx)(u.a,{className:"mt-5",children:Object(g.jsx)("h4",{children:"Services"})}),Object(g.jsx)(u.a,{className:"mainBox",children:a?Object(g.jsx)(m.a,{className:"d-flex border-0 justify-content-center",children:Object(g.jsx)(S.a,{type:"pacman",active:!0})}):Object(g.jsx)(m.a,{children:t.services.map((function(e,a){return Object(g.jsx)(y,{service:e,first:0===a,last:a===t.services.length-1,nameFlag:!0},e.id)}))})}),Object(g.jsx)(k,{})]})}function k(){var e=Object(o.useQuery)($),t=e.data,a=e.loading;return Object(g.jsxs)(g.Fragment,{children:[Object(g.jsx)(u.a,{children:Object(g.jsx)("h4",{className:"mt-5",children:"Overall Uptime"})}),Object(g.jsx)(u.a,{className:"mainBox overall",children:a?Object(g.jsx)(m.a,{className:"d-flex justify-content-center border-0",children:Object(g.jsx)(S.a,{type:"pacman",active:!0})}):Object(g.jsxs)(g.Fragment,{children:[Object(g.jsxs)(m.a,{children:[Object(g.jsx)(u.a,{className:"number",children:Object(g.jsxs)(m.a,{children:[t&&t.uptime1.toFixed(3),"%"]})}),Object(g.jsx)(u.a,{className:"title",children:Object(g.jsx)(m.a,{children:"Last 24 hours"})})]}),Object(g.jsxs)(m.a,{children:[Object(g.jsx)(u.a,{className:"number",children:Object(g.jsxs)(m.a,{children:[t&&t.uptime7.toFixed(3),"%"]})}),Object(g.jsx)(u.a,{className:"title",children:Object(g.jsx)(m.a,{children:"Last 7 days"})})]}),Object(g.jsxs)(m.a,{children:[Object(g.jsx)(u.a,{className:"number",children:Object(g.jsxs)(m.a,{children:[t&&t.uptime30.toFixed(3),"%"]})}),Object(g.jsx)(u.a,{className:"title",children:Object(g.jsx)(m.a,{children:"Last 30 days"})})]}),Object(g.jsxs)(m.a,{children:[Object(g.jsx)(u.a,{className:"number",children:Object(g.jsxs)(m.a,{children:[t&&t.uptime90.toFixed(3),"%"]})}),Object(g.jsx)(u.a,{className:"title",children:Object(g.jsx)(m.a,{children:"Last 90 days"})})]})]})})]})}var D,I,B,P,R,T,A=a(71),G=a(30),U=a(32),M=a(186),Q=a(105),V=a(187),E=a(58),H=a.n(E),J=a(0),z=a(59),K=Object(o.gql)(D||(D=Object(s.a)(["\n  mutation createService($name: String!, $url: String!, $interval: Float!, $timeout: Float!, $ping: Boolean!) {\n    createService(name: $name, url: $url, interval: $interval, timeout: $timeout, ping: $ping){\n      name\n    }\n  }\n"]))),W=Object(o.gql)(I||(I=Object(s.a)(["\n  mutation updateService($id: ID!, $options: ServiceUpdateOptions!) {\n    updateService(id:$id, options: $options){\n      id\n      name\n    }\n  }\n"]))),X=Object(o.gql)(B||(B=Object(s.a)(["\n  mutation updateOrder($id: ID!, $destination: Int!) {\n    updateOrder(id:$id, destination: $destination)\n  }\n"]))),Y=Object(o.gql)(P||(P=Object(s.a)(["\n  query Services {\n    services {\n      id\n      name\n      url\n      interval\n      timeout\n      order\n      ping\n      state\n    }\n  }\n"])));function Z(){var e=Object(J.useState)(!1),t=Object(U.a)(e,2),a=t[0],n=t[1],c=Object(o.useQuery)(Y,{fetchPolicy:"network-only"}),s=c.data,r={data:s,refetch:c.refetch};return a?Object(g.jsxs)(g.Fragment,{children:[Object(g.jsx)(ee,{}),s&&Object(g.jsxs)(g.Fragment,{children:[Object(g.jsx)(te,Object(G.a)({},r)),Object(g.jsx)(ae,Object(G.a)({},r))]})]}):Object(g.jsx)(_,{setLogged:n})}function _(e){var t=e.setLogged,a=Object(o.gql)(R||(R=Object(s.a)(["\n  mutation Login($key: String!){\n    login(key: $key)\n  }\n"]))),n=Object(o.useMutation)(a),c=Object(U.a)(n,2),r=c[0],i=c[1].loading;return Object(g.jsx)(M.a,{onSubmit:function(e){e.persist(),e.preventDefault();var a=H()(e.target,{hash:!0});r({variables:a}).then((function(e){j.b.success("Logged in succesfully!"),b.a.set("token",e.data.login,{sameSite:"Lax"}),t(!0)})).catch((function(e){console.log(e),j.b.error(e.graphQLErrors[0].message,{autoclose:!1})}))},children:Object(g.jsx)(u.a,{children:Object(g.jsxs)(m.a,{md:4,className:"mx-auto",children:[Object(g.jsx)(u.a,{children:Object(g.jsx)(m.a,{children:Object(g.jsxs)(Q.a,{children:[Object(g.jsx)("label",{htmlFor:"key",children:"Access Key:"}),Object(g.jsx)("input",{className:"ml-2",required:!0,type:"password",name:"key"})]})})}),Object(g.jsx)(u.a,{children:Object(g.jsx)(m.a,{children:Object(g.jsx)(V.a,{type:"submit",className:"w-100",color:"primary",children:i?Object(g.jsx)("img",{src:"",alt:"loading"}):"Login"})})})]})})})}function ee(){var e=Object(o.useMutation)(K),t=Object(U.a)(e,1)[0];return Object(g.jsxs)(M.a,{inline:!0,className:"mainBox p-4",onSubmit:function(e){var a=H()(e.target,{hash:!0});a.interval=parseFloat(a.interval),a.timeout=parseFloat(a.timeout),a.ping="on"===a.ping,t({variables:a}).then((function(t){j.b.success('Added service "'.concat(t.data.createService.name,'" succesfully!')),e.target.reset()})).catch((function(e){console.log(e),j.b.error(e.message,{autoclose:!1})})),e.preventDefault(),e.persist()},children:[Object(g.jsxs)(M.a.Row,{className:"w-100 pb-3",children:[Object(g.jsx)(m.a,{xs:"12",md:"4",children:Object(g.jsxs)(M.a.Group,{children:[Object(g.jsx)(M.a.Label,{className:"mr-2",children:"Name:"}),Object(g.jsx)(M.a.Control,{type:"text",name:"name",required:!0})]})}),Object(g.jsx)(m.a,{xs:"12",md:"4",children:Object(g.jsxs)(M.a.Group,{children:[Object(g.jsx)(M.a.Label,{className:"mr-2",children:"Url:"}),Object(g.jsx)(M.a.Control,{type:"text",name:"url",required:!0})]})}),Object(g.jsx)(m.a,{xs:"12",md:"4",children:Object(g.jsxs)(M.a.Group,{children:[Object(g.jsx)(M.a.Label,{className:"mr-2",children:"Ping mode:"}),Object(g.jsx)(M.a.Control,{type:"checkbox",name:"ping"})]})})]}),Object(g.jsxs)(M.a.Row,{className:"w-100 pb-3",children:[Object(g.jsx)(m.a,{xs:"12",md:"4",children:Object(g.jsxs)(M.a.Group,{children:[Object(g.jsx)(M.a.Label,{className:"mr-2",children:"Interval:"}),Object(g.jsx)(M.a.Control,{type:"number",min:0,defaultValue:5e3,name:"interval",required:!0})]})}),Object(g.jsx)(m.a,{xs:"12",md:"4",children:Object(g.jsxs)(M.a.Group,{children:[Object(g.jsx)(M.a.Label,{className:"mr-2",children:"Timeout:"}),Object(g.jsx)(M.a.Control,{type:"number",min:0,defaultValue:3e3,name:"timeout",required:!0})]})}),Object(g.jsx)(m.a,{xs:"auto",children:Object(g.jsx)(V.a,{type:"submit",children:"Add Service"})})]})]})}function te(e){var t=e.data,a=e.refetch,n=Object(o.useMutation)(W),c=Object(U.a)(n,1)[0],s=Object(A.a)(t.services).sort((function(e,t){return e.id-t.id})),r=Object(J.useState)(s[0]),i=Object(U.a)(r,2),l=i[0],d=i[1],b=Object(J.useRef)(null);return Object(J.useEffect)((function(){return b.current.reset()}),[l]),Object(g.jsxs)("div",{className:"mainBox p-4 mt-3",children:[Object(g.jsx)(M.a.Row,{className:"w-100",children:Object(g.jsx)(m.a,{xs:"12",children:Object(g.jsx)(M.a.Group,{children:Object(g.jsx)(M.a.Control,{as:"select",onChange:function(e){return d(s.find((function(t){return t.id===e.target.value})))},children:s.map((function(e){return Object(g.jsx)("option",{value:e.id,children:"(".concat(e.id,") ").concat(e.name)},e.id)}))})})})}),Object(g.jsxs)(M.a,{inline:!0,className:"mt-2",onSubmit:function(e){e.preventDefault(),e.persist();var t=H()(e.target,{hash:!0});t.interval=parseFloat(t.interval),t.timeout=parseFloat(t.timeout),t.ping="on"===t.ping;for(var n=0,s=Object.keys(t);n<s.length;n++){var r=s[n];l[r]===t[r]&&delete t[r]}0!==Object.keys(t).length&&c({variables:{id:l.id,options:t}}).then((function(t){j.b.success('Updated service "'.concat(t.data.updateService.name,'" succesfully!')),e.target.reset(),setTimeout((function(){return a()}),1e4)})).catch((function(e){console.log(e),j.b.error(e.message,{autoclose:!1})}))},ref:b,children:[Object(g.jsxs)(M.a.Row,{className:"w-100 pb-3",children:[Object(g.jsx)(m.a,{xs:"12",md:"4",children:Object(g.jsxs)(M.a.Group,{children:[Object(g.jsx)(M.a.Label,{className:"mr-2",children:"Name:"}),Object(g.jsx)(M.a.Control,{type:"text",name:"name",required:!0,defaultValue:l.name})]})}),Object(g.jsx)(m.a,{xs:"12",md:"4",children:Object(g.jsxs)(M.a.Group,{children:[Object(g.jsx)(M.a.Label,{className:"mr-2",children:"Url:"}),Object(g.jsx)(M.a.Control,{type:"text",name:"url",required:!0,defaultValue:l.url})]})}),Object(g.jsx)(m.a,{xs:"12",md:"4",children:Object(g.jsxs)(M.a.Group,{children:[Object(g.jsx)(M.a.Label,{className:"mr-2",children:"Ping mode:"}),Object(g.jsx)(M.a.Control,{type:"checkbox",name:"ping",defaultChecked:l.ping})]})})]}),Object(g.jsxs)(M.a.Row,{className:"w-100",children:[Object(g.jsx)(m.a,{xs:"12",md:"4",children:Object(g.jsxs)(M.a.Group,{children:[Object(g.jsx)(M.a.Label,{className:"mr-2",children:"Interval:"}),Object(g.jsx)(M.a.Control,{type:"number",min:0,name:"interval",required:!0,defaultValue:l.interval})]})}),Object(g.jsx)(m.a,{xs:"12",md:"4",children:Object(g.jsxs)(M.a.Group,{children:[Object(g.jsx)(M.a.Label,{className:"mr-2",children:"Timeout:"}),Object(g.jsx)(M.a.Control,{type:"number",min:0,name:"timeout",required:!0,defaultValue:l.timeout})]})}),Object(g.jsx)(m.a,{xs:"auto",children:Object(g.jsx)(V.a,{type:"submit",children:"Add Service"})})]})]})]})}function ae(e){var t=e.data,a=e.refetch,n=Object(o.useMutation)(X),c=Object(U.a)(n,1)[0],s=Object(A.a)(t.services).sort((function(e,t){return e.order-t.order}));return Object(g.jsx)("div",{className:"row mainBox py-0 px-0 mt-3",children:Object(g.jsx)("div",{className:"col px-0",children:Object(g.jsx)(z.a,{onDragEnd:function(e){e.destination&&c({variables:{id:e.draggableId,destination:e.destination.index}}).then((function(){return j.b.success("Update succesful!")})).catch((function(e){console.log(e),j.b.error("Update failed")})).finally(a)},children:Object(g.jsx)(z.c,{droppableId:"droppable",children:function(e,t){return Object(g.jsxs)("div",Object(G.a)(Object(G.a)({},e.droppableProps||{}),{},{ref:e.innerRef,style:(t.isDraggingOver,{padding:8}),children:[s.map((function(e){return Object(g.jsx)(z.b,{draggableId:e.id,index:e.order,children:function(t,a){return Object(g.jsx)("div",Object(G.a)(Object(G.a)(Object(G.a)({className:"w-100 py-3 px-4 orderRow",ref:t.innerRef},t.draggableProps),t.dragHandleProps),{},{style:(a.isDragging,n=t.draggableProps?t.draggableProps.style:{},Object(G.a)({padding:16,margin:"0 0 ".concat(8,"px 0")},n)),children:Object(g.jsx)("h5",{className:"d-inline align-middle",children:e.name})}),e.id);var n}},e.id)})),e.placeholder]}))}})})})})}var ne=Object(o.gql)(T||(T=Object(s.a)(["\n  query Services($id: ID!) {\n    service(id: $id) {\n      id\n      name\n      url\n      order\n      state\n\n      uptimeDays(days: 90) {\n        date\n        uptime\n      }\n\n      uptime1: uptime(days: 1)\n      uptime7: uptime(days: 7)\n      uptime30: uptime(days: 30)\n      uptime90: uptime(days: 90)\n\n      response: responseTime(days: 2){\n        avg\n        min\n        max\n      }\n    }\n  }\n"])));function ce(e){var t=Object(o.useQuery)(ne,{variables:{id:e.id}}),a=t.data,n=t.loading;return Object(g.jsxs)(g.Fragment,{children:[Object(g.jsx)("h4",{children:"Uptime Last 90 days"}),Object(g.jsx)(u.a,{className:"mainBox",children:n?Object(g.jsx)(m.a,{className:"d-flex border-0 justify-content-center",children:Object(g.jsx)(S.a,{type:"pacman",active:!0})}):Object(g.jsx)(m.a,{children:a&&Object(g.jsx)(y,{service:a.service,first:!0,last:!0},a.service.id)})}),Object(g.jsx)(se,{data:a,loading:n}),Object(g.jsx)(re,{data:a,loading:n})]})}function se(e){var t=e.data,a=e.loading;return Object(g.jsxs)(g.Fragment,{children:[Object(g.jsx)("h4",{className:"mt-5",children:"Overall Uptime"}),Object(g.jsx)(u.a,{className:"mainBox overall",children:a?Object(g.jsx)(m.a,{className:"d-flex border-0 justify-content-center",children:Object(g.jsx)(S.a,{type:"pacman",active:!0})}):Object(g.jsxs)(g.Fragment,{children:[Object(g.jsxs)(m.a,{children:[Object(g.jsx)(u.a,{className:"number",children:Object(g.jsxs)(m.a,{children:[t&&t.service.uptime1.toFixed(3),"%"]})}),Object(g.jsx)(u.a,{className:"title",children:Object(g.jsx)(m.a,{children:"Last 24 hours"})})]}),Object(g.jsxs)(m.a,{children:[Object(g.jsx)(u.a,{className:"number",children:Object(g.jsxs)(m.a,{children:[t&&t.service.uptime7.toFixed(3),"%"]})}),Object(g.jsx)(u.a,{className:"title",children:Object(g.jsx)(m.a,{children:"Last 7 days"})})]}),Object(g.jsxs)(m.a,{children:[Object(g.jsx)(u.a,{className:"number",children:Object(g.jsxs)(m.a,{children:[t&&t.service.uptime30.toFixed(3),"%"]})}),Object(g.jsx)(u.a,{className:"title",children:Object(g.jsx)(m.a,{children:"Last 30 days"})})]}),Object(g.jsxs)(m.a,{children:[Object(g.jsx)(u.a,{className:"number",children:Object(g.jsxs)(m.a,{children:[t&&t.service.uptime90.toFixed(3),"%"]})}),Object(g.jsx)(u.a,{className:"title",children:Object(g.jsx)(m.a,{children:"Last 90 days"})})]})]})})]})}function re(e){var t=e.data,a=e.loading;return Object(g.jsxs)(g.Fragment,{children:[Object(g.jsx)("h4",{className:"mt-5",children:"Response Time Last 2 days "}),Object(g.jsx)(u.a,{className:"mainBox overall",children:Object(g.jsx)(m.a,{style:{border:"none"},children:Object(g.jsx)(u.a,{children:a?Object(g.jsx)(m.a,{className:"d-flex border-0 justify-content-center",children:Object(g.jsx)(S.a,{type:"pacman",active:!0})}):Object(g.jsxs)(g.Fragment,{children:[Object(g.jsxs)(m.a,{children:[Object(g.jsx)(u.a,{className:"number",children:Object(g.jsxs)(m.a,{children:[t&&t.service.response.avg.toFixed(2),"ms"]})}),Object(g.jsx)(u.a,{className:"title",children:Object(g.jsx)(m.a,{children:"Avg. response time"})})]}),Object(g.jsxs)(m.a,{children:[Object(g.jsx)(u.a,{className:"number",children:Object(g.jsxs)(m.a,{children:[t&&t.service.response.max.toFixed(2),"ms"]})}),Object(g.jsx)(u.a,{className:"title",children:Object(g.jsx)(m.a,{children:"Max. response time"})})]}),Object(g.jsxs)(m.a,{children:[Object(g.jsx)(u.a,{className:"number",children:Object(g.jsxs)(m.a,{children:[t&&t.service.response.min.toFixed(2),"ms"]})}),Object(g.jsx)(u.a,{className:"title",children:Object(g.jsx)(m.a,{children:"Min. response time"})})]})]})})})})]})}var ie,le=Object(J.createContext)(),je=a(184),de={"/":function(){return Object(g.jsx)(C,{})},"/service/:id":function(e){var t=e.id;return Object(g.jsx)(ce,{id:t})},"/admin":function(){return Object(g.jsx)(Z,{})}},be=new o.HttpLink({uri:"/api"}),oe=new o.ApolloLink((function(e,t){var a=b.a.get("token");return a&&e.setContext({headers:{authorization:"Bearer ".concat(a)}}),t(e)})),ue=new o.ApolloClient({cache:new o.InMemoryCache,link:Object(o.from)([oe,be])});function me(){var e=Object(o.useQuery)(Object(o.gql)(ie||(ie=Object(s.a)(["query Title{ \n    title \n    footer\n  }"])))).data,t=Object(l.useRoutes)(de);return Object(g.jsxs)(g.Fragment,{children:[Object(g.jsx)(j.a,{newestOnTop:!0}),Object(g.jsxs)(je.a,{children:[Object(g.jsx)(u.a,{className:"my-4 py-2",children:Object(g.jsx)("h1",{className:"title",onClick:function(){return Object(l.navigate)("/")},children:e?e.title:""})}),t||Object(g.jsx)("div",{}),e&&i()(e.footer)]})]})}var xe=function(){return Object(g.jsx)(o.ApolloProvider,{client:ue,children:Object(g.jsx)(le.Provider,{value:{},children:Object(g.jsx)(me,{})})})},Oe=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,188)).then((function(t){var a=t.getCLS,n=t.getFID,c=t.getFCP,s=t.getLCP,r=t.getTTFB;a(e),n(e),c(e),s(e),r(e)}))};c.a.render(Object(g.jsx)(xe,{}),document.getElementById("root")),Oe()}},[[177,1,2]]]);
//# sourceMappingURL=main.57a2a179.chunk.js.map