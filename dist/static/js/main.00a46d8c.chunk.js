(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{102:function(e,t,s){},127:function(e,t){},166:function(e,t,s){"use strict";s.r(t);var a,c,n=s(22),r=s.n(n),i=s(26),l=(s(100),s(101),s(102),s(88)),j=s.n(l),d=s(35),m=s(37),b=s(89),x=s.n(b),u=s(14),o=s(171),O=s(90),h=s(174),p=s(172),v=s(49),y=s(6),f=s.n(y),N=s(2);function g(e){var t="";return null!==e&&(t="green",e<99&&(t="lightgreen"),e<95&&(t="yellow"),e<90&&(t="red")),t}function F(e){var t=e.first,s=e.last,a=e.service,c=e.nameFlag,n=void 0!==c&&c,r=a.name,i=a.uptimeDays,l=a.state,j=i.map((function(e){return e.uptime})),m=j.reduce((function(e,t){return e+t}),0)/j.length,b=function(e){for(var t=e.start.startOf("day"),s=e.end.endOf("day"),a=[];t<s;)a.push(t.toISODate()),t=t.plus({days:1});return a}(v.Interval.fromDateTimes(v.DateTime.now().minus({days:89}),v.DateTime.now()));return Object(N.jsx)(o.a,{className:f()("infoRow",{first:t,"pt-4":!t,"pb-4":!s}),children:Object(N.jsxs)(O.a,{children:[Object(N.jsxs)(o.a,{className:"info",children:[Object(N.jsxs)(O.a,{className:"pl-0",children:[n&&Object(N.jsxs)(N.Fragment,{children:[Object(N.jsx)(d.A,{href:"/service/".concat(a.id),children:Object(N.jsxs)("span",{style:{color:"white"},children:[r," \u279f "]})}),Object(N.jsx)("span",{className:"mx-1",children:"|"})]}),Object(N.jsxs)("span",{className:g(m),children:[m.toFixed(2),"%"]})]}),Object(N.jsxs)(O.a,{xs:"auto",className:f()("d-flex align-items-center pr-0",{lightgreen:l,red:!l}),children:[Object(N.jsx)("div",{className:"status mx-1",style:{width:"20px",height:"20px"}}),Object(N.jsx)("span",{children:l?"Operational":"Down"})]})]}),Object(N.jsx)(o.a,{className:"flex-nowrap mt-3 justify-content-end",children:b.map((function(e){var t=i.find((function(t){return t.date===e}));return Object(N.jsx)(w,{date:e,value:t?t.uptime:null},e)}))})]})})}function w(e){var t=e.value,s=e.date,a=g(t);return Object(N.jsx)(h.a,{placement:"top",overlay:Object(N.jsxs)(p.a,{children:[s,Object(N.jsx)("br",{}),t?"".concat(t.toFixed(2),"%"):""]}),children:Object(N.jsx)(O.a,{className:"tick px-0",children:Object(N.jsx)("div",{className:a})})})}var L=Object(u.gql)(a||(a=Object(i.a)(["\n  query Services {\n    services {\n      id\n      name\n      url\n      order\n      state\n\n      uptimeDays(days: 90) {\n        date\n        uptime\n      }\n    }\n  }\n"]))),q=Object(u.gql)(c||(c=Object(i.a)(["\n  query Overall {\n    uptime1: uptime(days: 1)\n    uptime7: uptime(days: 7)\n    uptime30: uptime(days: 30)\n    uptime90: uptime(days: 90)\n  }\n"])));function S(){var e=Object(u.useQuery)(L).data,t=e&&e.services.every((function(e){return e.state})),s=e&&e.services.every((function(e){return!e.state}));return Object(N.jsxs)(N.Fragment,{children:[Object(N.jsx)(o.a,{className:f()("mainBox",{yellow:!s&&!t,red:s,lightgreen:t}),children:Object(N.jsxs)(O.a,{className:"d-flex align-items-center",children:[Object(N.jsx)("div",{className:"status mr-2",style:{width:"20px",height:"20px"}}),Object(N.jsx)("h2",{className:"my-auto",style:{fontWeight:"bold"},children:s||t?t?"All systems operational":"All systems down":"Some systems down"})]})}),Object(N.jsx)(o.a,{className:"mt-5",children:Object(N.jsx)("h4",{children:"Services"})}),Object(N.jsx)(o.a,{className:"mainBox",children:Object(N.jsx)(O.a,{children:e&&e.services.map((function(t,s){return Object(N.jsx)(F,{service:t,first:0===s,last:s===e.services.length-1,nameFlag:!0},t.id)}))})}),Object(N.jsx)(C,{})]})}function C(){var e=Object(u.useQuery)(q).data;return Object(N.jsxs)(N.Fragment,{children:[Object(N.jsx)(o.a,{children:Object(N.jsx)("h4",{className:"mt-5",children:"Overall Uptime"})}),Object(N.jsxs)(o.a,{className:"mainBox overall",children:[Object(N.jsxs)(O.a,{children:[Object(N.jsx)(o.a,{className:"number",children:Object(N.jsxs)(O.a,{children:[e&&e.uptime1.toFixed(3),"%"]})}),Object(N.jsx)(o.a,{className:"title",children:Object(N.jsx)(O.a,{children:"Last 24 hours"})})]}),Object(N.jsxs)(O.a,{children:[Object(N.jsx)(o.a,{className:"number",children:Object(N.jsxs)(O.a,{children:[e&&e.uptime7.toFixed(3),"%"]})}),Object(N.jsx)(o.a,{className:"title",children:Object(N.jsx)(O.a,{children:"Last 7 days"})})]}),Object(N.jsxs)(O.a,{children:[Object(N.jsx)(o.a,{className:"number",children:Object(N.jsxs)(O.a,{children:[e&&e.uptime30.toFixed(3),"%"]})}),Object(N.jsx)(o.a,{className:"title",children:Object(N.jsx)(O.a,{children:"Last 30 days"})})]}),Object(N.jsxs)(O.a,{children:[Object(N.jsx)(o.a,{className:"number",children:Object(N.jsxs)(O.a,{children:[e&&e.uptime90.toFixed(3),"%"]})}),Object(N.jsx)(o.a,{className:"title",children:Object(N.jsx)(O.a,{children:"Last 90 days"})})]})]})]})}var D,T,$=s(95),A=s(175),B=s(176),k=s(94),I=s.n(k),R=Object(u.gql)(D||(D=Object(i.a)(["\n  mutation createService($name: String!, $url: String!, $interval: Float!, $timeout: Float!) {\n    createService(name: $name, url: $url, interval: $interval, timeout: $timeout){\n      name\n    }\n  }\n"])));function G(){var e=Object(u.useMutation)(R),t=Object($.a)(e,1)[0];return Object(N.jsxs)(A.a,{inline:!0,className:"mainBox p-4",onSubmit:function(e){var s=I()(e.target,{hash:!0});s.interval=parseFloat(s.interval),s.timeout=parseFloat(s.timeout),t({variables:s}).then((function(t){m.b.success('Added service "'.concat(t.data.createService.name,'" succesfully!')),e.target.reset()})).catch((function(e){console.log(e),m.b.error(e.message,{autoclose:!1})})),e.preventDefault(),e.persist()},children:[Object(N.jsxs)(A.a.Row,{className:"w-100 pb-3",children:[Object(N.jsx)(O.a,{xs:"12",md:"auto",children:Object(N.jsxs)(A.a.Group,{children:[Object(N.jsx)(A.a.Label,{className:"mr-2",children:"Name:"}),Object(N.jsx)(A.a.Control,{type:"text",name:"name",required:!0})]})}),Object(N.jsx)(O.a,{xs:"12",md:"auto",children:Object(N.jsxs)(A.a.Group,{children:[Object(N.jsx)(A.a.Label,{className:"mr-2",children:"Url:"}),Object(N.jsx)(A.a.Control,{type:"text",name:"url",required:!0})]})})]}),Object(N.jsxs)(A.a.Row,{className:"w-100 pb-3",children:[Object(N.jsx)(O.a,{xs:"12",md:"auto",children:Object(N.jsxs)(A.a.Group,{children:[Object(N.jsx)(A.a.Label,{className:"mr-2",children:"Interval:"}),Object(N.jsx)(A.a.Control,{type:"number",min:0,defaultValue:5e3,name:"interval",required:!0})]})}),Object(N.jsx)(O.a,{xs:"12",md:"auto",children:Object(N.jsxs)(A.a.Group,{children:[Object(N.jsx)(A.a.Label,{className:"mr-2",children:"Timeout:"}),Object(N.jsx)(A.a.Control,{type:"number",min:0,defaultValue:3e3,name:"timeout",required:!0})]})}),Object(N.jsx)(O.a,{xs:"auto",children:Object(N.jsx)(B.a,{type:"submit",children:"Add Service"})})]})]})}var M=Object(u.gql)(T||(T=Object(i.a)(["\n  query Services($id: ID!) {\n    service(id: $id) {\n      id\n      name\n      url\n      order\n      state\n\n      uptimeDays(days: 90) {\n        date\n        uptime\n      }\n\n      uptime1: uptime(days: 1)\n      uptime7: uptime(days: 7)\n      uptime30: uptime(days: 30)\n      uptime90: uptime(days: 90)\n\n      response: responseTime(days: 2){\n        avg\n        min\n        max\n      }\n    }\n  }\n"])));function P(e){var t=Object(u.useQuery)(M,{variables:{id:e.id}}).data;return Object(N.jsxs)(N.Fragment,{children:[Object(N.jsx)("h4",{children:"Uptime Last 90 days"}),Object(N.jsx)(o.a,{className:"mainBox",children:Object(N.jsx)(O.a,{children:t&&Object(N.jsx)(F,{service:t.service,first:!0,last:!0},t.service.id)})}),Object(N.jsx)(Q,{data:t}),Object(N.jsx)(U,{data:t})]})}function Q(e){var t=e.data;return Object(N.jsxs)(N.Fragment,{children:[Object(N.jsx)("h4",{className:"mt-5",children:"Overall Uptime"}),Object(N.jsxs)(o.a,{className:"mainBox overall",children:[Object(N.jsxs)(O.a,{children:[Object(N.jsx)(o.a,{className:"number",children:Object(N.jsxs)(O.a,{children:[t&&t.service.uptime1.toFixed(3),"%"]})}),Object(N.jsx)(o.a,{className:"title",children:Object(N.jsx)(O.a,{children:"Last 24 hours"})})]}),Object(N.jsxs)(O.a,{children:[Object(N.jsx)(o.a,{className:"number",children:Object(N.jsxs)(O.a,{children:[t&&t.service.uptime7.toFixed(3),"%"]})}),Object(N.jsx)(o.a,{className:"title",children:Object(N.jsx)(O.a,{children:"Last 7 days"})})]}),Object(N.jsxs)(O.a,{children:[Object(N.jsx)(o.a,{className:"number",children:Object(N.jsxs)(O.a,{children:[t&&t.service.uptime30.toFixed(3),"%"]})}),Object(N.jsx)(o.a,{className:"title",children:Object(N.jsx)(O.a,{children:"Last 30 days"})})]}),Object(N.jsxs)(O.a,{children:[Object(N.jsx)(o.a,{className:"number",children:Object(N.jsxs)(O.a,{children:[t&&t.service.uptime90.toFixed(3),"%"]})}),Object(N.jsx)(o.a,{className:"title",children:Object(N.jsx)(O.a,{children:"Last 90 days"})})]})]})]})}function U(e){var t=e.data;return Object(N.jsxs)(N.Fragment,{children:[Object(N.jsx)("h4",{className:"mt-5",children:"Response Time Last 2 days "}),Object(N.jsx)(o.a,{className:"mainBox overall",children:Object(N.jsx)(O.a,{style:{border:"none"},children:Object(N.jsxs)(o.a,{children:[Object(N.jsxs)(O.a,{children:[Object(N.jsx)(o.a,{className:"number",children:Object(N.jsxs)(O.a,{children:[t&&t.service.response.avg.toFixed(2),"ms"]})}),Object(N.jsx)(o.a,{className:"title",children:Object(N.jsx)(O.a,{children:"Avg. response time"})})]}),Object(N.jsxs)(O.a,{children:[Object(N.jsx)(o.a,{className:"number",children:Object(N.jsxs)(O.a,{children:[t&&t.service.response.max.toFixed(2),"ms"]})}),Object(N.jsx)(o.a,{className:"title",children:Object(N.jsx)(O.a,{children:"Max. response time"})})]}),Object(N.jsxs)(O.a,{children:[Object(N.jsx)(o.a,{className:"number",children:Object(N.jsxs)(O.a,{children:[t&&t.service.response.min.toFixed(2),"ms"]})}),Object(N.jsx)(o.a,{className:"title",children:Object(N.jsx)(O.a,{children:"Min. response time"})})]})]})})})]})}var J,V=s(0),z=Object(V.createContext)(),E=s(173),H={"/":function(){return Object(N.jsx)(S,{})},"/service/:id":function(e){var t=e.id;return Object(N.jsx)(P,{id:t})},"/admin":function(){return Object(N.jsx)(G,{})}},W=new u.HttpLink({uri:"/api"}),K=new u.ApolloLink((function(e,t){var s=x.a.get("token");return s&&e.setContext({headers:{authorization:s}}),t(e)})),X=new u.ApolloClient({cache:new u.InMemoryCache,link:Object(u.from)([K,W])});function Y(){var e=Object(u.useQuery)(Object(u.gql)(J||(J=Object(i.a)(["query Title{ \n    title \n    footer\n  }"])))).data,t=Object(d.useRoutes)(H);return Object(N.jsxs)(N.Fragment,{children:[Object(N.jsx)(m.a,{newestOnTop:!0}),Object(N.jsxs)(E.a,{children:[Object(N.jsx)(o.a,{className:"my-4 py-2",children:Object(N.jsx)("h1",{className:"title",onClick:function(){return Object(d.navigate)("/")},children:e?e.title:""})}),t||Object(N.jsx)("div",{}),e&&j()(e.footer)]})]})}var Z=function(){return Object(N.jsx)(u.ApolloProvider,{client:X,children:Object(N.jsx)(z.Provider,{value:{},children:Object(N.jsx)(Y,{})})})},_=function(e){e&&e instanceof Function&&s.e(3).then(s.bind(null,177)).then((function(t){var s=t.getCLS,a=t.getFID,c=t.getFCP,n=t.getLCP,r=t.getTTFB;s(e),a(e),c(e),n(e),r(e)}))};r.a.render(Object(N.jsx)(Z,{}),document.getElementById("root")),_()}},[[166,1,2]]]);
//# sourceMappingURL=main.00a46d8c.chunk.js.map